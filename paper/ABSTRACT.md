# 中文摘要

## 题目

事件驱动体系结构模拟器的设计与实现：以Coral NPU为案例

## 摘要

随着处理器设计的复杂度不断增加，体系结构模拟成为评估和优化处理器设计的关键工具。然而，传统的循环驱动模拟器在处理大规模、多核系统时存在性能和扩展性问题。本论文提出并实现了一个基于事件驱动离散事件模拟(DES)原理的通用体系结构模拟框架，并将其应用于Coral NPU的建模。

### 主要贡献

#### 1. 事件驱动模拟框架
本论文详细阐述了事件驱动离散事件模拟的核心原理和实现方法：
- **事件系统设计**: 包括事件类型、事件优先级、事件ID等核心概念
- **事件调度算法**: 采用优先级队列实现O(logN)时间复杂度的事件调度
- **时间管理机制**: 通过事件时间戳实现精确的逻辑时间管理，避免时间同步问题
- **周期性事件支持**: 扩展事件系统以支持周期性重复事件

相比传统循环驱动模拟器，事件驱动方法在处理稀疏事件流时可显著降低模拟时间。

#### 2. 通用的体系结构建模方法学
本论文提出了一套完整的体系结构建模抽象框架，包括五个核心概念：

- **Port（端口）**: 作为组件的通信接口，支持输入、输出、双向通信。端口采用模板无关的设计，通过运行时类型检查支持多种数据类型。

- **Component（组件）**: 是体系结构的基本单元，可组合、可复用。组件通过端口相互连接，支持初始化、复位、启用/禁用等生命周期方法。

- **Connection（连接）**: 定义了端口间的通信模式，支持多种握手协议：
  - 简单线连接（Wire）
  - 有效-就绪握手（Ready-Valid）
  - 信用流控制（Credit）
  - 寄存器文件互联（RegisterFile Wire）

- **Pipeline（流水线）**: 通过多级流水线建模指令执行过程。流水线支持：
  - 自定义每级的处理函数
  - 每级的独立延迟设置
  - 灵活的暂停(Stall)谓词
  - 数据流和延迟追踪

- **Stage（级）**: 流水线的基本构建块，提供过程化数据处理模型。Stage独立于Pipeline的时钟，支持组合式或时序式处理。

这套方法学具有高度的通用性，可应用于不同类型和复杂度的体系结构。

#### 3. Coral NPU的完整建模案例
本论文展示了将建模方法学应用于实际处理器的完整过程，建模了Coral NPU的两个核心组件：

**标量核心(Scalar Core)**:
- 五级指令流水线: Fetch → Decode → Dispatch → Execute → Writeback
- 五个功能单元的并行执行: ALU, BRU(分支), MLU(乘法), DVU(除法), LSU(访存)
- 记分板实现的的冒险检测
- 多端口寄存器文件
- 完整的控制流支持

**向量后端(RVV Backend)**:
- 支持RISC-V向量扩展(RVV)的向量指令执行
- 三级流水线: Dispatch → Execute → Retire
- 多发射的向量微操作
- 乱序执行与有序退休的ROB实现
- 向量寄存器文件
- 向量ALU和向量除法单元

### 研究意义

1. **学术意义**: 提供了一个可供参考的事件驱动模拟框架实现，可用于学术研究和教学
2. **工程意义**: 提供了可直接使用的模拟工具，可用于处理器设计的快速评估
3. **扩展性**: 该框架的通用设计使其可扩展到更复杂的体系结构（如乱序执行、多核、缓存层次等）

### 论文结构

**第一章** 详细阐述事件驱动模拟的核心原理，包括：
- 事件与事件队列的概念和实现
- 优先级调度算法及其时间复杂度分析
- 与循环驱动模拟的对比
- 性能考量与优化策略

**第二章** 系统介绍通用的建模方法学，包括：
- 五个核心概念的完整定义和实现
- 各概念间的关系与组合方式
- 不同通信协议的实现细节
- 生命周期管理与初始化流程

**第三章** 展示具体的建模案例，包括：
- Coral NPU标量核心的指令流水线建模
- 五个功能单元的详细实现
- RVV向量后端的多级流水线建模
- 核心与向量后端的集成策略

### 关键术语

| 术语 | 定义 |
|------|------|
| 事件(Event) | 在特定逻辑时间发生的原子动作 |
| 事件队列 | 按时间顺序排列的事件集合 |
| 事件驱动 | 根据事件发生主动推进模拟的方法 |
| 组件(Component) | 体系结构的基本单元，具有端口和内部状态 |
| 端口(Port) | 组件的通信接口 |
| 连接(Connection) | 不同通信模式的连接原语 |
| 流水线(Pipeline) | 多级串行处理结构 |
| 记分板 | 指令冒险检测机制 |
| ROB | 乱序执行中的退休缓冲区 |

### 适用读者

- **体系结构设计者**: 可借鉴本框架设计自己的模拟工具
- **处理器模拟研究者**: 可将本框架作为研究基础
- **计算机体系结构学生**: 可通过本论文学习现代模拟技术
- **芯片设计工程师**: 可使用本框架评估设计

### 数据统计

| 项目 | 数量 |
|------|------|
| 总字数 | 约80,000字 |
| 代码行数 | 约2,000行(精选) |
| 图表数量 | 约40+幅 |
| 核心类数量 | 约25+个 |
| 支持功能单元 | 8+ (ALU, FPU, LSU, TPU等) |

### 联系方式

如对本论文有任何建议或问题，欢迎通过GitHub Repository提交Issue。

---

**关键词**: 事件驱动模拟, 体系结构建模, Coral NPU, 向量扩展, 流水线

**发布日期**: 2025年11月  
**版本**: 1.0
